# PRD: 発語・ジェスチャー記録アプリ（研究寄り）

## 1. 背景
乳幼児の言語発達は「音 → 単語 → 文 → 会話」と段階的に進む。  
このアプリは、親が日常的に手入力した発語やジェスチャーをJSON形式で記録し、**後処理で発達段階や語の意味変化を可視化**することを目的とする。  
研究寄りの用途を想定し、**発語イベントの証拠性**と**語ごとの意味変化タイムライン**の両方を扱う。

---

## 2. 目的
- 発語とジェスチャーの発達を体系的に記録する  
- 語彙数や文の複雑さを自動集計し、発達段階を判定する  
- **意味拡張（semantic over/under extension, shift）**を時系列で追跡できるようにする  
- 親にとっては日記的にも使える（随時メモ入力）  

---

## 3. ユースケース
- 親が日常の発語を簡単に入力  
- 発語イベントにジェスチャーや文脈を添付  
- 自由メモを随時追加（日記的利用）  
- 自動で「語ごとの意味タイムライン」が生成される  
- アプリが「現在：語彙増加期」などを提示  

---

## 4. 記録対象
### 4.1 発語イベント
- **テキスト**：聞き取った単語/文  
- **分類**：coo / babble / word_like / word / phrase  
- **語彙ID**：`word_id`（同じ語をひも付けるキー）  
- **意味拡張**：intended_meaning, original_meaning, relation (exact/over/under/shift/unknown)  
- **ジェスチャー**：有無・種類・対象  
- **文脈**：routine, interlocutor, location  
- **補足メモ**：自由入力  

### 4.2 フリーメモイベント（随時）
- 発語以外の行動・日常観察を自由入力  
- タグ付けや関連イベントとのリンクも可能  

### 4.3 語ごとの意味タイムライン
- 同じ `word_id` に属するイベントを集計し、**意味が変わった区間を日付付きで管理**  
- 各状態に証拠イベントIDを紐付ける  

---

## 5. データ構造

### 5.1 発語イベント（証拠）
```json
{
  "event_id": "evt-20250821-0915",
  "type": "utterance",
  "v": 1,
  "child_id": "kid_001",

  "timestamp": "2025-08-21T09:15:00+09:00",
  "age_month": 14,

  "utterance": {
    "word_id": "w_oppai",
    "text": "おっぱい",
    "form": "word",
    "lang": "ja",
    "mlu_words": 1
  },

  "semantics": {
    "intended_meaning": "スプーン",
    "original_meaning": "母乳",
    "relation": "overextension",
    "judged_by": "parent"
  },

  "gesture": { "present": true, "type": "point" },
  "context": { "routine": "meal", "interlocutor": "mother" },

  "notes_free": "食事準備中に使用。"
}
```

### 5.2 フリーメモイベント
```json
{
  "event_id": "evt-20250821-2030",
  "type": "note",
  "v": 1,
  "child_id": "kid_001",

  "timestamp": "2025-08-21T20:30:00+09:00",
  "age_month": 14,

  "note": {
    "text": "公園で初めてすべり台を一人で滑った。"
  },
  "tags": ["daily_observation", "motor"]
}
```

### 5.3 語ごとの意味タイムライン（要約ビュー）
```json
{
  "word_id": "w_oppai",
  "surface_form": "おっぱい",
  "states": [
    {
      "state_id": "st-0001",
      "start_date": "2025-08-10",
      "end_date": "2025-08-17",
      "meaning": "母乳",
      "relation": "exact",
      "judged_by": "parent",
      "evidence_event_ids": ["evt-20250810-0900", "evt-20250812-1830"]
    },
    {
      "state_id": "st-0002",
      "start_date": "2025-08-18",
      "end_date": null,
      "meaning": "スプーン",
      "relation": "overextension",
      "judged_by": "parent",
      "evidence_event_ids": ["evt-20250818-1830", "evt-20250821-0915"]
    }
  ]
}
```

---

## 6. サマリ（日次/週次）
- 累積語彙数・新出語数  
- 二語文・三語文の出現  
- 助詞・接続詞の初出  
- 意味拡張の件数・進行中の語リスト  
- 現在の推定段階（初語期 / 語彙増加期 / 二語文期 / 文の発達期 / 複雑な文期）

---

## 7. 段階判定ロジック（例）
- 初語期：有意味語 ≥ 1  
- 語彙増加期：累積語彙 ≥ 50  
- 二語文期：MLU ≥ 2 の初出  
- 文の発達期：助詞 or 三語文が出現  
- 複雑な文期：接続詞・疑問文・時制表現の定常使用  

---

## 8. UI要件
- 入力モード2種：  
  - 発語記録（タイプ＋テキスト＋ジェスチャー）  
  - フリーメモ（テキストのみ）  
- タイムライン表示（発語🗣・メモ📝を区別）  
- 語詳細画面：**意味変化のタイムライン**を日付軸で可視化  
- 親向けフィードバック：  
  - 語彙数グラフ  
  - ステージ表示（現在の発達段階と一般的目安月齢）  

---

## 9. 拡張性
- `age_month` と `timestamp` の両方を保持（分析に便利）  
- `word_id` による語単位の管理  
- `states` により、複数回の意味変化を時系列で追跡可能  
- `notes_free` により将来のNLP解析にも対応可能  
- `v` と `_ext` によりスキーマ拡張に備える  

---

## 10. 非機能要件
- 入力負担を最小化（3ステップ入力＋自由メモ）  
- データ改変防止：イベントは一次データとして保存、タイムラインは後処理で再構成  
- プライバシー保護（共有範囲設定、音声/写真は任意）  
- 監査性（意味拡張は親の判断と明示、証拠イベントIDを紐付け）  

---

✅ まとめ  
- **イベント（点）**：瞬間の発語・ジェスチャー・意味判断を保存  
- **タイムライン（線）**：同一語の意味変化を時系列にまとめる  
- 親の主観判断を尊重しつつ、後処理で研究分析に耐えるデータ構造を持つ  
